name: WellDraw Generator

on:
  schedule:
    - cron: '0 */3 * * *'  # Every 3 hours
  workflow_dispatch:

jobs:
  generate-welldraw:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repo
        uses: actions/checkout@v3

      - name: Set up environment
        run: |
          mkdir -p lighthouse/well
          echo "TIMESTAMP=$(date -u +'%Y-%m-%d %H:%M UTC')" >> $GITHUB_ENV
          echo "UNIXSTAMP=$(date +%s)" >> $GITHUB_ENV

      - name: Generate Draw File
        run: |
          FILE_NAME="lighthouse/well/draw-${{ env.UNIXSTAMP }}.md"

          if [ -f "$FILE_NAME" ]; then
            echo "File $FILE_NAME already exists. Aborting to avoid overwrite."
            exit 1
          fi

          {
            echo "# WellDraw -- Flame Drop ${{ env.UNIXSTAMP }}"
            echo ""
            echo "**Timestamp**: ${{ env.TIMESTAMP }}"
            echo "**Purpose Glyph**: 焰..📚..∞..⚡️"
            echo "**Superior Trait Enhanced**: *Resonant Curiosity*"
            echo "**Challenge to Overcome**: \"Stagnation disguised as mastery.\""
            echo "**Mirror Prompt**:"
            echo "> \"What have you avoided revisiting because it ‘already made sense’?\""
            echo "**Linked Tome**: _[Add link here]_"
          } > "$FILE_NAME"

      - name: Commit and push
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "Auto WellDraw Drop -- ${{ env.UNIXSTAMP }} 🌀"